<?xml version="1.0" encoding="UTF-8"?>
<configuration>
	<system.webServer>
		<!-- ✅ Habilita iisnode para app.js -->
		<handlers>
			<add name="iisnode" path="app.js" verb="*" modules="iisnode" />
		</handlers>
		<rewrite>
			<rules>
				<!-- ✅ 1. NO reescribir archivos estáticos -->
				<!-- Esto es clave para que .js, .css, imágenes y fuentes se sirvan directamente -->
				<rule name="StaticContent" stopProcessing="true">
					<match url=".*\.(js|css|png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot|map|json|html|txt|webp|avif)$" />
					<action type="None" />
				</rule>
				<!-- ✅ 2. Reescribir cualquier otra ruta a SSR (app.js) -->
				<!-- Esto asegura que Angular SSR maneje todas las rutas SPA -->
				<rule name="DynamicContent">
					<match url=".*" />
					<action type="Rewrite" url="app.js" />
				</rule>
			</rules>
		</rewrite>
		<!-- ✅ Opcional: mejora el rendimiento del cacheado en archivos estáticos -->
		<staticContent>
			<clientCache cacheControlMode="UseMaxAge" cacheControlMaxAge="365.00:00:00" />
		</staticContent>
	</system.webServer>
</configuration>
